# SPDX-FileCopyrightText: 2025 Weibo, Inc.
#
# SPDX-License-Identifier: Apache-2.0

# =============================================================================
# Chat Shell Service Configuration
# =============================================================================
# Note: All environment variables use CHAT_SHELL_ prefix
# Example: CHAT_SHELL_MODE=http

# Environment configuration
# Set to "development" for debug mode, "production" for production
CHAT_SHELL_ENVIRONMENT=development

# Enable/disable API docs (Swagger UI at /docs)
CHAT_SHELL_ENABLE_API_DOCS=True

# =============================================================================
# Running Mode
# =============================================================================
# "package" - used as a Python package imported by Backend
# "http" - runs as an independent HTTP service (default)
# "cli" - command-line interface mode
CHAT_SHELL_MODE=http

# =============================================================================
# Storage Configuration
# =============================================================================
# "memory" - in-memory storage (for testing)
# "sqlite" - local SQLite storage (for CLI)
# "remote" - calls Backend API (for production HTTP mode)
CHAT_SHELL_STORAGE_TYPE=remote

# SQLite configuration (for CLI mode)
CHAT_SHELL_SQLITE_DB_PATH=~/.chat_shell/history.db

# Remote storage configuration (calls Backend API)
# Default: http://backend:8000/api/internal (Docker) or http://localhost:8000/api/internal (local)
CHAT_SHELL_REMOTE_STORAGE_URL=http://localhost:8000/api/internal
CHAT_SHELL_REMOTE_STORAGE_TOKEN=

# =============================================================================
# HTTP Server Configuration
# =============================================================================
CHAT_SHELL_HTTP_HOST=0.0.0.0
CHAT_SHELL_HTTP_PORT=8001

# Internal service authentication token
CHAT_SHELL_INTERNAL_SERVICE_TOKEN=

# =============================================================================
# LLM API Keys
# =============================================================================
# At least one API key is required for chat functionality
CHAT_SHELL_ANTHROPIC_API_KEY=
CHAT_SHELL_OPENAI_API_KEY=
CHAT_SHELL_GOOGLE_API_KEY=

# =============================================================================
# Default Model Configuration
# =============================================================================
CHAT_SHELL_DEFAULT_MODEL=claude-3-5-sonnet-20241022
CHAT_SHELL_DEFAULT_TEMPERATURE=0.7
CHAT_SHELL_DEFAULT_MAX_TOKENS=4096

# =============================================================================
# Chat Configuration
# =============================================================================
# Maximum concurrent chat sessions
CHAT_SHELL_MAX_CONCURRENT_CHATS=50
# Chat history expiration time (seconds)
CHAT_SHELL_CHAT_HISTORY_EXPIRE_SECONDS=7200
# Maximum messages to keep in history
CHAT_SHELL_CHAT_HISTORY_MAX_MESSAGES=50
# API timeout for LLM calls (seconds)
CHAT_SHELL_CHAT_API_TIMEOUT_SECONDS=300

# Tool calling flow limits
# Maximum LLM requests in tool calling flow
CHAT_SHELL_CHAT_TOOL_MAX_REQUESTS=10
# Maximum time for tool calling flow (seconds)
CHAT_SHELL_CHAT_TOOL_MAX_TIME_SECONDS=60.0

# Group chat history configuration
# In group chat mode, AI-bot sees: first N messages + last M messages (no duplicates)
CHAT_SHELL_GROUP_CHAT_HISTORY_FIRST_MESSAGES=10
CHAT_SHELL_GROUP_CHAT_HISTORY_LAST_MESSAGES=20

# Message compression configuration
CHAT_SHELL_MESSAGE_COMPRESSION_ENABLED=True
CHAT_SHELL_MESSAGE_COMPRESSION_FIRST_MESSAGES=2
CHAT_SHELL_MESSAGE_COMPRESSION_LAST_MESSAGES=10
CHAT_SHELL_MESSAGE_COMPRESSION_ATTACHMENT_LENGTH=50000

# =============================================================================
# MCP (Model Context Protocol) Configuration
# =============================================================================
# Enable/disable MCP tools (default: False)
CHAT_SHELL_CHAT_MCP_ENABLED=False
# MCP server configurations as JSON string (similar to Claude Desktop format)
# Supported server types: stdio, sse, streamable-http
# Example configurations:
# - SSE server: {"mcpServers":{"image-gen":{"type":"sse","url":"http://localhost:8080/sse","headers":{"Authorization":"Bearer xxx"}}}}
# - stdio server: {"mcpServers":{"ppt-gen":{"type":"stdio","command":"npx","args":["-y","@example/ppt-mcp-server"],"env":{"API_KEY":"xxx"}}}}
CHAT_SHELL_CHAT_MCP_SERVERS={}

# =============================================================================
# Web Search Configuration
# =============================================================================
# Enable/disable web search feature (default: False)
CHAT_SHELL_WEB_SEARCH_ENABLED=False
# Search API configuration as JSON string
CHAT_SHELL_WEB_SEARCH_ENGINES={}
# Default maximum number of search results
CHAT_SHELL_WEB_SEARCH_DEFAULT_MAX_RESULTS=50

# =============================================================================
# Workspace Configuration
# =============================================================================
# Root directory for workspace operations
CHAT_SHELL_WORKSPACE_ROOT=/workspace
# Enable/disable skills (default: True)
CHAT_SHELL_ENABLE_SKILLS=True
# Enable/disable checkpointing (default: False)
CHAT_SHELL_ENABLE_CHECKPOINTING=False

# =============================================================================
# Attachment/Context Configuration
# =============================================================================
# Maximum extracted text length from attachments
CHAT_SHELL_MAX_EXTRACTED_TEXT_LENGTH=100000

# Backend RAG service URL (for knowledge base HTTP fallback)
CHAT_SHELL_BACKEND_RAG_URL=http://localhost:8000/api/knowledge/v1/retrieve

# =============================================================================
# OpenTelemetry Configuration
# =============================================================================
# Enable/disable OpenTelemetry tracing (default: False)
OTEL_ENABLED=False
# Service name for tracing
OTEL_SERVICE_NAME=wegent-chat-shell
# OTLP exporter endpoint (gRPC)
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# Sampling rate (0.0 to 1.0, default: 1.0 = 100%)
OTEL_TRACES_SAMPLER_ARG=1.0
# Enable/disable metrics export
OTEL_METRICS_ENABLED=False
# HTTP capture settings
OTEL_CAPTURE_REQUEST_HEADERS=False
OTEL_CAPTURE_REQUEST_BODY=False
OTEL_CAPTURE_RESPONSE_HEADERS=False
OTEL_CAPTURE_RESPONSE_BODY=False

# =============================================================================
# Graceful Shutdown Configuration
# =============================================================================
# Maximum time to wait for active streaming requests to complete (seconds)
# Default: 600 seconds (10 minutes)
CHAT_SHELL_GRACEFUL_SHUTDOWN_TIMEOUT=600
