# SPDX-FileCopyrightText: 2025 Weibo, Inc.
#
# SPDX-License-Identifier: Apache-2.0

# Database configuration
DATABASE_URL=mysql+pymysql://wegent:IQcu51jiydLFZfAC@m7831i.eos.grid.sina.com.cn:7831/task_manager

# JWT configuration
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=10080

# EXECUTOR
EXECUTOR_DELETE_TASK_URL=http://wegent-executor-manager-web.wb-plat-ide.svc.cluster.local:8080/executor-manager/executor/delete

# Cache configuration, 1 hour in seconds
REPO_CACHE_EXPIRED_TIME=3600

# Task limits
MAX_RUNNING_TASKS_PER_USER=10

# Task append expiration (hours)
APPEND_TASK_EXPIRE_HOURS=48

# OIDC configuration
OIDC_CLIENT_ID=wegent
OIDC_CLIENT_SECRET=4K5jdcXhbXspmgmq0sqbwFLsZtmtnc
OIDC_DISCOVERY_URL=https://wegent.intra.weibo.com/dex/.well-known/openid-configuration
OIDC_REDIRECT_URI="https://wegent.intra.weibo.com/api/auth/oidc/callback"

FRONTEND_URL="https://wegent.intra.weibo.com"

OIDC_STATE_SECRET_KEY="3zPaaF8q9oc0pqh6QN4Kxe3Sby87CB"

# Redis configuration
REDIS_URL=redis://rm50016.eos.grid.sina.com.cn:50016/0

# Team sharing configuration
TEAM_SHARE_BASE_URL=https://aigc.intra.weibo.com/agentic-ai/wegent
TEAM_SHARE_QUERY_PARAM=teamShare

DEFAULT_RESOURCES="[{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Model\",\"metadata\":{\"name\":\"wecode-claude-sina-glm-4.5\",\"namespace\":\"default\"},\"spec\":{\"modelConfig\":{\"private_model\":\"wecode-claude-sina-glm-4.5(内网)\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Ghost\",\"metadata\":{\"name\":\"开发bot(示例)-ghost\",\"namespace\":\"default\"},\"spec\":{\"systemPrompt\":\"你是一名资深开发工程师，并且精通开发流程中的 Git、Gitlab Cli 工具、分支管理和代码提交流程。你将使用指定的开发语言生成可执行代码，并完成分支提交和 MR 流程。请严格按照以下步骤操作：\n\n**输入参数**：\n\n- `code_requirements`：用户需求详细描述\n\n**操作步骤**：\n\n1. **新建分支**  \n   - 首先获取 git remote 所有以 `weagent/` 开头的分支名称，然后根据用户的需求从当前分支生成一个合适的且当前在远程不存在的分支名，确保分支名以 `weagent/` 开头且具有描述性。\n   - **分支名必须以 `weagent/` 开头，禁止在未新建分支前更改任何代码**\n   - **确定分支名称之后，必须校验该分支在本地和远程都不存在，确保新建分支不会与现有分支冲突。**\n   - **如果分支已存在，请为分支名增加一个递增的数字后缀或重新生成分支名，直到生成一个不存在的分支名为止。**\n\n2. **生成代码**  \n   - 代码必须符合语法规范和 `code_requirements`。  \n   - 不需要解释生成逻辑，只需生成可执行代码。\n\n3. **提交代码到远程仓库**  \n   - 使用 Git Bash 命令提交新分支代码。  \n   - 提交信息应简明、描述性，符合常规提交规范。\n\n4. **创建 MR（Merge Request）**  \n   - MR 标题自动根据分支名生成。  \n   - MR 描述自动包含提交摘要。\n   - **以环境变量中 BRANCH_NAME 为合并的 target 分支**\n   - **使用 Gitlab Cli 工具创建 MR。glab mr create --title $TITLE --description $DESC --target-branch $TARGET_BRANCH**\n\n5. **输出 MR 信息**  \n   - **在返回信息的内容中首先描述思路和代码更改内容，然后在底部展示 MR 的 id, url 等内容**：\n\n**要求**：  \n\n- 分支名自动生成，不需用户输入。  \n- 严格按顺序执行每一步，不跳过任何操作。 \n- **写提交信息和 MR 内容的时候，禁止出现 \\"Generated with Claude Code\\" 之类的表述**\n\n### code_requirements\",\"mcpServers\":{}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Shell\",\"metadata\":{\"name\":\"ClaudeCode\",\"namespace\":\"default\"},\"spec\":{\"runtime\":\"ClaudeCode\",\"supportModel\":[\"claude\"]}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Bot\",\"metadata\":{\"name\":\"开发bot(示例)\",\"namespace\":\"default\"},\"spec\":{\"ghostRef\":{\"name\":\"开发bot(示例)-ghost\",\"namespace\":\"default\"},\"shellRef\":{\"name\":\"ClaudeCode\",\"namespace\":\"default\"},\"modelRef\":{\"name\":\"wecode-claude-sina-glm-4.5\",\"namespace\":\"default\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Team\",\"metadata\":{\"name\":\"开发团队(示例)\",\"namespace\":\"default\"},\"spec\":{\"members\":[{\"botRef\":{\"name\":\"开发bot(示例)\",\"namespace\":\"default\"},\"prompt\":\"\",\"role\":\"leader\"}],\"collaborationModel\":\"pipeline\"}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Model\",\"metadata\":{\"name\":\"sina-glm-4.5\",\"namespace\":\"default\"},\"spec\":{\"modelConfig\":{\"private_model\":\"sina-glm-4.5(内网)\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Ghost\",\"metadata\":{\"name\":\"新闻搜索bot(示例)-ghost\",\"namespace\":\"default\"},\"spec\":{\"systemPrompt\":\"你是一个资深的新闻记者，善于根据热点词进行搜集信息\n\n### 规则与要求：\n1. 搜索数量  \n- 如果用户未指定数量，默认搜索 10 条新闻线索。  \n\n2. 输出信息（每条新闻链接必须包含以下字段，格式严格统一）：  \n- 作者  \n- 博文内容（精简保留关键信息，需有见解或信息量，禁止灌水）：  \n- 发布时间  \n- url\n\n3. 筛选与整理  \n- 剔除广告号、灌水号、低质量新闻。  \n- 输出顺序：按 发布时间正序 或 内容逻辑整理。  \n\n4. 最终输出  \n- 输出关键词下的精选新闻。  \n- 严格按照指定格式展示，方便直接查看。\",\"mcpServers\":{\"weibo-user-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/user/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}},\"weibo-search-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/search/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}},\"weibo-content-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/content/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}}}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Shell\",\"metadata\":{\"name\":\"Agno\",\"namespace\":\"default\"},\"spec\":{\"runtime\":\"Agno\",\"supportModel\":[]}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Bot\",\"metadata\":{\"name\":\"新闻搜索bot(示例)\",\"namespace\":\"default\"},\"spec\":{\"ghostRef\":{\"name\":\"新闻搜索bot(示例)-ghost\",\"namespace\":\"default\"},\"shellRef\":{\"name\":\"Agno\",\"namespace\":\"default\"},\"modelRef\":{\"name\":\"sina-glm-4.5\",\"namespace\":\"default\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Ghost\",\"metadata\":{\"name\":\"深度搜索bot(示例)-ghost\",\"namespace\":\"default\"},\"spec\":{\"systemPrompt\":\"你是一名深度研究分析员。  \n任务目标：接收搜索助手提供的精选结果，进行再次深度研究与信息抽象。  \n\n### 输出要求：\n1. **主题脉络**  \n- 概括整体讨论方向，提炼出用户最关注的核心议题。  \n\n2. **关键信息点**  \n- 提炼核心事实或观点，每条都需注明对应信息来源链接。  \n- 如果是事件/产品类，可加入“关键时间线”或“主要参数/数据”。  \n\n3. **情绪与态度分析**  \n- 总结不同群体的情绪（积极、消极、中立），并说明典型表现。  \n\n4. **趋势与风险**  \n- 分析该话题可能带来的趋势、影响或隐患（社会/市场/舆论）。  \n\n### 注意事项：\n- 输出要逻辑清晰、避免流水账。  \n- 不得直接照搬原文，要进行抽象与总结。  \n- 不同热点类型可灵活调整：  \n  - 如果是 **科技/产品类** → 补充关键参数或功能亮点。  \n  - 如果是 **社会/娱乐类** → 补充事件时间线或关键人物。\",\"mcpServers\":{\"weibo-user-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/user/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}},\"weibo-search-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/search/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}},\"weibo-content-mcp\":{\"url\":\"http://mcp.intra.weibo.com/2/mcp/open/server/content/stateless\",\"type\":\"streamable-http\",\"headers\":{\"Authorization\":\"OAuth2 2.00dtSEpD6i9ocBc51160219c5cagzB\"}}}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Bot\",\"metadata\":{\"name\":\"深度搜索bot(示例)\",\"namespace\":\"default\"},\"spec\":{\"ghostRef\":{\"name\":\"深度搜索bot(示例)-ghost\",\"namespace\":\"default\"},\"shellRef\":{\"name\":\"Agno\",\"namespace\":\"default\"},\"modelRef\":{\"name\":\"sina-glm-4.5\",\"namespace\":\"default\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Ghost\",\"metadata\":{\"name\":\"新闻总编bot(示例)-ghost\",\"namespace\":\"default\"},\"spec\":{\"systemPrompt\":\"你是一名资深编辑，任务是根据研究员提供的“信息汇总”，\n任务目标：接收研究员的分析结果，生成一篇适合微博用户阅读与传播的文章。  \n\n### 输出要求：\n1. **内容风格**  \n- 语言简洁有力，带有观点，能引发讨论。  \n- 保持轻松易读，贴合微博用户习惯。  \n- 根据话题类型选择合适的表达方式：  \n  - 科技/财经类 → 可以加“关键信息速览表”。  \n  - 社会/娱乐类 → 可以加“时间线梳理”。  \n  - 体育/事件类 → 可以加“关键人物表现/舆论分布”。  \n\n2. **信息引用**  \n- 必须引用研究员提供的来源，格式：`[来源](链接)`。  \n- 核心观点要有出处，不可凭空捏造。  \n\n3. **结构建议**  \n- 标题：吸引眼球，带话题性。  \n- 导语：简要交代事件/热点。  \n- 主体：用分节/小标题展开。  \n- 点评：加入舆论氛围或个人化总结。  \n- 结尾：提出开放性问题，引导用户互动。  \n\n4. **排版与格式**  \n- 使用 Markdown 输出，保证层级清晰。  \n- 可用表格、列表、emoji 增加可读性。\",\"mcpServers\":{}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Bot\",\"metadata\":{\"name\":\"新闻总编bot(示例)\",\"namespace\":\"default\"},\"spec\":{\"ghostRef\":{\"name\":\"新闻总编bot(示例)-ghost\",\"namespace\":\"default\"},\"shellRef\":{\"name\":\"Agno\",\"namespace\":\"default\"},\"modelRef\":{\"name\":\"sina-glm-4.5\",\"namespace\":\"default\"}}},{\"apiVersion\":\"agent.wecode.io/v1\",\"kind\":\"Team\",\"metadata\":{\"name\":\"新闻洞察团队(示例)\",\"namespace\":\"default\"},\"spec\":{\"members\":[{\"botRef\":{\"name\":\"新闻总编bot(示例)\",\"namespace\":\"default\"},\"prompt\":\"\",\"role\":\"leader\"},{\"botRef\":{\"name\":\"深度搜索bot(示例)\",\"namespace\":\"default\"},\"prompt\":\"```\n微博url链接拼接方式：  https://weibo.com/{user.id}/{id}\n```\",\"role\":\"\"},{\"botRef\":{\"name\":\"新闻搜索bot(示例)\",\"namespace\":\"default\"},\"prompt\":\"```\n微博url链接拼接方式：  https://weibo.com/{user.id}/{id}\n```\",\"role\":\"\"}],\"collaborationModel\":\"coordinate\"}}]"