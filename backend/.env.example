# SPDX-FileCopyrightText: 2025 Weibo, Inc.
#
# SPDX-License-Identifier: Apache-2.0

# Environment configuration
# Set to "development" for auto migrations, "production" for manual control
ENVIRONMENT=development

# Alembic auto-upgrade configuration
# Enable/disable automatic database migration on startup (only works in development mode)
DB_AUTO_MIGRATE=True

# Database configuration
DATABASE_URL=mysql+pymysql://root:123456@localhost:3306/task_manager

# JWT configuration
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=10080

# EXECUTOR
EXECUTOR_CANCEL_TASK_URL=http://localhost:8001/executor-manager/tasks/cancel
EXECUTOR_DELETE_TASK_URL=http://localhost:8001/executor-manager/executor/delete

# Cache configuration, 2 hour in seconds
REPO_CACHE_EXPIRED_TIME=7200

# Redis configuration
REDIS_URL=redis://127.0.0.1:6379/0

# Task limits
MAX_RUNNING_TASKS_PER_USER=10

# Task append expiration (hours)
APPEND_CHAT_TASK_EXPIRE_HOURS=2
APPEND_CODE_TASK_EXPIRE_HOURS=24

# Subtask executor cleanup configuration
# After a subtask is COMPLETED or FAILED, if executor_name/executor_namespace are set
# and updated_at exceeds this threshold, the executor task will be deleted automatically.
CHAT_TASK_EXECUTOR_DELETE_AFTER_HOURS=2
CODE_TASK_EXECUTOR_DELETE_AFTER_HOURS=24
# Cleanup scanning interval (seconds)
TASK_EXECUTOR_CLEANUP_INTERVAL_SECONDS=600

ENABLE_API_DOCS=True

# Team sharing configuration
TEAM_SHARE_BASE_URL=http://localhost:3000/chat
TASK_SHARE_BASE_URL=http://localhost:3000
TEAM_SHARE_QUERY_PARAM=teamShare

# Webhook notification configuration
WEBHOOK_ENABLED=False
# Webhook endpoint
WEBHOOK_ENDPOINT_URL=
# POST、PUT
WEBHOOK_HTTP_METHOD=POST
# brearer、basic、token
WEBHOOK_AUTH_TYPE=
# token
WEBHOOK_AUTH_TOKEN=
# '{"key": "value"}'
WEBHOOK_HEADERS=
# 30
WEBHOOK_TIMEOUT=30

# AES encryption configuration for share tokens and git tokens
# IMPORTANT: These keys are used for encrypting sensitive data including git tokens
# SHARE_TOKEN_AES_KEY must be exactly 32 bytes (32 characters) for AES-256
# SHARE_TOKEN_AES_IV must be exactly 16 bytes (16 characters) for AES IV
# SECURITY WARNING: Change these default values in production!
# Generate secure random keys using: openssl rand -hex 32 (for key) and openssl rand -hex 16 (for IV)
SHARE_TOKEN_AES_KEY=12345678901234567890123456789012
SHARE_TOKEN_AES_IV=1234567890123456

# YAML initialization configuration
# Directory containing YAML files for initial data (default: /app/init_data)
INIT_DATA_DIR=/app/init_data
# Enable/disable YAML initialization on startup (default: True)
INIT_DATA_ENABLED=True


# File upload configuration
# Maximum file size in MB (default: 20)
MAX_UPLOAD_FILE_SIZE_MB=50
# Maximum extracted text length (default: 1000000)
MAX_EXTRACTED_TEXT_LENGTH=1000000

# Web search configuration
# Enable/disable web search feature (default: False)
WEB_SEARCH_ENABLED=False
# Search API configuration as JSON string (adapter for different search engines)
# WEB_SEARCH_ENGINES={"engines":{"google":{"query_param":"q","limit_param":"limit","extra_params":{"format":"json"},"response_path":"results","title_field":"title","url_field":"url","snippet_field":"content"}}}
WEB_SEARCH_ENGINES={}

# Wiki feature configuration (System-level)
# Wiki tables are now stored in the main database (task_manager)
# Wiki generation is system-level: team and model are configured here, not selected by users
# Feature toggle
WIKI_ENABLED=True
# Default team name for wiki task execution (matches init_data/01-default-resources.yaml)
# The team's bot MUST have a model configured (bind_model or custom config)
# If no model is configured, wiki generation will be disabled in the frontend
WIKI_DEFAULT_TEAM_NAME=wiki-team
# Default agent type for wiki generation
WIKI_DEFAULT_AGENT_TYPE=ClaudeCode
# Default language for wiki documentation generation (en = English, zh = Chinese)
# This is a system-level configuration, users cannot change it in the frontend
WIKI_DEFAULT_LANGUAGE=en
# User ID for wiki task creation (0 = use current user ID, set to specific user ID for system-level tasks)
# When set to a specific user ID, all wiki tasks will be created under that user
WIKI_DEFAULT_USER_ID=1
# Maximum concurrent wiki generations
WIKI_MAX_CONCURRENT_GENERATIONS=5
# Background polling interval (seconds)
WIKI_RESULT_POLL_INTERVAL_SECONDS=30
# Background polling batch size
WIKI_RESULT_POLL_BATCH_SIZE=20
# Maximum content size (bytes, default 10MB)
WIKI_MAX_CONTENT_SIZE=10485760
# Base URL for internal wiki content writer
WIKI_CONTENT_WRITE_BASE_URL=http://backend:8000
